# NextJS IPFS DApp 
## Description
A full stack decentralized application developed with Javascript using the Web3 libraries and dependencies to connect to and run on any blockchain network and IPFS network. 

## Features
1. Connect to blockchain network
2. Store an uploaded json file
3. Get file by passing its CID
4. Get all files stored
5. Remove all files stored (Removing of data is not possible but it is there if you desire to implement some functionality to it)

## Frontend App
### Installation
1. Create **_environment.js_** file in project root directory
2. Set the following environment variables in that file
```js
import { Web3Storage } from "web3.storage";
export const WEB3_CLIENT = new Web3Storage({
  token: // Api Token
});
export const CONTRACT_ADDRESS = // Contract address
export const CONTRACT_ABI = // Contract abi
```
**_NOTE:_** 
- **_Contract address_** and **_Contract abi_** are obtained after deployment of smart contract usually located in project files of smart contract development frameworks used to code then run deployment scripts. Some example frameworks are Hardhat, Truffle, or Foundry.
- **_Api token_** can be generated by following the instructions in [Generate Web3 Storage Api Token Doc](https://web3.storage/docs/how-tos/generate-api-token/).

3. Run npm commands
```shell
npm install
npm run dev
``` 

## Blockchain Network
### Installation
1. Pick one smart contract development framework [Hardhat](https://hardhat.org/hardhat-runner/docs/getting-started#overview), [Truffle](https://trufflesuite.com/truffle/), or [Foundry](https://book.getfoundry.sh/)
2. Create **_DistributedStorage.sol_** file as smart contract in framework project directory
```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

contract DistributedStorage {
    mapping(string cid => string url) private _files;
    File[] private allFiles;

    struct File {
        string cid;
        string url;
    }

    function storeFiles(File[] memory files) public {
        for (uint256 i = 0; i < files.length; i++) {
            if (checkAllFiles(files[i].cid)) {
                _files[files[i].cid] = files[i].url;
                allFiles.push(File(files[i].cid, files[i].url));
            }
        }
    }

    function getFile(string memory cid) public view returns (string memory) {
        return _files[cid];
    }

    function getAllFiles() public view returns (File[] memory) {
        return allFiles;
    }

    function checkAllFiles(string memory cid) public view returns (bool) {
        for (uint256 i = 0; i < allFiles.length; i++) {
            if (keccak256(bytes(allFiles[i].cid)) == keccak256(bytes(cid))) {
                return false;
            }
        }
        return true;
    }

    function removeAllFiles() public returns (File[] memory) {
        // Implement some remove functionality if desired
        return allFiles;
    }
}
```
3. Deploy smart contract with framework commands
4. Download [Metamask](https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn) browser plugin 
5. Pick a blockchain network to use like [Ganache](https://trufflesuite.com/ganache/)
6. Run blockchain network
7. Set metamask network settings to **RPC URL** and **CHAIN ID** of blockchain network
8. Import private key of account in blockchain network to metamask
